(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{363:function(t,e,n){var content=n(370);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("082a52aa",content,!0,{sourceMap:!1})},364:function(t,e,n){var content=n(372);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("4df29923",content,!0,{sourceMap:!1})},365:function(t,e,n){var content=n(374);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("7dbc2a4a",content,!0,{sourceMap:!1})},366:function(t,e,n){var content=n(376);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(13).default)("fc181852",content,!0,{sourceMap:!1})},367:function(t,e,n){"use strict";n(48),n(25),n(18),n(16),n(37),n(26);var o=n(19),r=n(27);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={name:"event",components:{},props:[],data:function(){return{eventContentHtml:"",eventContent:"",isLoading:!1,selectedDate:new Date,editMode:!1,eventId:null}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(source,!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(r.b)({blockMode:function(t){return t.blockMode},blockSelected:function(t){return t.blockSelected},eventList:function(t){return t.event.eventList}})),mounted:function(){this.$set(this,"selectedDate",new Date(this.blockSelected))},watch:{blockSelected:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.$set(this,"selectedDate",new Date(this.blockSelected)),this.isLoading="eventList",t.next=4,regeneratorRuntime.awrap(this.getEventList());case 4:this.isLoading=!1;case 5:case"end":return t.stop()}}),null,this)}},methods:{selectDate:function(t){this.selectedDate=t},updateContent:function(t){this.eventContent=t.target.innerText},getEventList:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regeneratorRuntime.awrap(this.$store.dispatch("event/getEventList",{time:this.$moment(this.selectedDate).format("YYYY-MM-DD"),mode:this.blockMode}));case 2:case"end":return t.stop()}}),null,this)},submit:function(){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading="submit",t.next=3,regeneratorRuntime.awrap(this.$store.dispatch("event/save",{content:this.eventContent,time:this.$moment(this.selectedDate).format("YYYY-MM-DD"),image:null,permission:1,id:this.eventId}));case 3:return t.next=5,regeneratorRuntime.awrap(this.getEventList());case 5:this.cancelEditEvent();case 6:case"end":return t.stop()}}),null,this)},editEvent:function(t){this.editMode=!0,this.eventContentHtml=this.eventContent=t.content,this.selectedDate=new Date(t.time),this.eventId=t.id},cancelEditEvent:function(){this.isLoading=!1,this.editMode=!1,this.eventContentHtml=this.eventContent=null,this.eventId=null}}},d=(n(373),n(6)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"event"},[n("div",{staticClass:"event-editor"},[n("div",{staticClass:"event-box",attrs:{contenteditable:"content",placeholder:t.$t("event.writeSomething")},domProps:{innerHTML:t._s(t.eventContentHtml)},on:{keyup:t.updateContent}}),t._v(" "),n("div",{staticClass:"date-picker float-left mt-1"},[n("div",{staticClass:"input-group mb-3"},[n("datepicker",{attrs:{value:t.selectedDate,format:"dd/MM/yyyy",language:t.$datepicker[t.$store.state.locale],"monday-first":!0,"calendar-button-icon-content":"event","input-class":"fix-calendar-input"},on:{selected:t.selectDate}},[n("span",{staticClass:"fix-calendar-icon",attrs:{slot:"afterDateInput"},slot:"afterDateInput"},[n("Fa",{attrs:{icon:["fas","calendar"]}})],1)])],1)]),t._v(" "),n("button",{staticClass:"btn btn-sm btn-info float-right",attrs:{type:"button",disabled:!t.eventContent||"submit"==t.isLoading},on:{click:t.submit}},["submit"==t.isLoading?n("Fa",{attrs:{icon:["fas","spinner"]}}):t._e(),t._v("\n      "+t._s(t.$t("event.submit"))+"\n    ")],1),t._v(" "),t.editMode?n("button",{staticClass:"btn btn-light btn-sm float-right",attrs:{type:"button"},on:{click:t.cancelEditEvent}},[t._v("\n      "+t._s(t.$t("event.cancel"))+"\n    ")]):t._e(),t._v(" "),n("div",{staticClass:"clearfix"})]),t._v(" "),"eventList"!=t.isLoading?n("div",{staticClass:"event-list",class:{"lj-blur-content":t.editMode}},t._l(t.eventList,(function(e,o){return n("div",{key:"event-"+o,staticClass:"event-item"},[n("div",{staticClass:"title"},[n("span",{staticClass:"time"},[t._v("\n          "+t._s(t.$moment(e.time).format(t.$store.state.dateFormat))+"\n        ")]),t._v(" "),n("div",{staticClass:"option option-delete"},[n("Fa",{attrs:{icon:["fas","trash"]}})],1),t._v(" "),n("div",{staticClass:"option option-edit",on:{click:function(n){return t.editEvent(e)}}},[n("Fa",{attrs:{icon:["fas","pen"]}})],1)]),t._v(" "),n("div",{staticClass:"content"},[t._v("\n        "+t._s(e.content)+"\n      ")])])})),0):n("div",{staticClass:"event-list-loading"},[n("Fa",{staticClass:"mr-1",attrs:{icon:["fas","spinner"]}}),t._v("\n    "+t._s(t.$t("event.isEventLoading"))+"\n  ")],1)])}),[],!1,null,"6e136994",null);e.a=component.exports},369:function(t,e,n){"use strict";var o=n(363);n.n(o).a},370:function(t,e,n){(t.exports=n(12)(!1)).push([t.i,".block[data-v-23f7a8fc]{display:inline;width:20px;height:20px;float:left;margin-right:1px;margin-bottom:1px;background:#eee;text-align:center}.block.past[data-v-23f7a8fc]{background:#ccc}.block[data-v-23f7a8fc]:hover{outline:1px solid #33b5e5}.block.selected[data-v-23f7a8fc]{outline:1px solid #ff3547}",""])},371:function(t,e,n){"use strict";var o=n(364);n.n(o).a},372:function(t,e,n){(t.exports=n(12)(!1)).push([t.i,"",""])},373:function(t,e,n){"use strict";var o=n(365);n.n(o).a},374:function(t,e,n){(t.exports=n(12)(!1)).push([t.i,".event[data-v-6e136994]{padding:5px;height:100%}.event .event-editor[data-v-6e136994]{margin-bottom:10px}.event .event-editor .event-box[data-v-6e136994]{width:100%;height:100px;border:1px solid #ddd;padding:5px;border-radius:3px;overflow:auto;background:#fff}.event .event-editor .event-box[data-v-6e136994]:focus{outline:none;box-shadow:0 0 0 .2rem rgba(0,123,255,.25)}.event-list[data-v-6e136994]{height:calc(100% - 147.5px);overflow:auto}.event-list .event-item[data-v-6e136994]{margin-bottom:5px;border:1px solid #ddd;background:#fff}.event-list .event-item .title[data-v-6e136994]{background:#33b5e5;color:#fff;padding:5px;outline:1px solid #33b5e5;position:relative}.event-list .event-item .title .time[data-v-6e136994]{width:auto;color:#fff}.event-list .event-item .title .option[data-v-6e136994]{background:#299ac3;position:absolute;width:31px;height:31px;top:0;text-align:center;vertical-align:middle;line-height:31px;cursor:pointer;user-select:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none}.event-list .event-item .title .option[data-v-6e136994]:hover{background:#2ba2ce}.event-list .event-item .title .option[data-v-6e136994]:active{background:#299ac3}.event-list .event-item .title .option-delete[data-v-6e136994]{right:0}.event-list .event-item .title .option-edit[data-v-6e136994]{right:31px}.event-list .event-item .content[data-v-6e136994]{padding:5px;min-height:70px}.event-list-loading[data-v-6e136994]{height:calc(100% - 147.5px);display:-webkit-box;display:flex;-webkit-box-pack:center;justify-content:center;-webkit-box-align:center;align-items:center}",""])},375:function(t,e,n){"use strict";var o=n(366);n.n(o).a},376:function(t,e,n){(t.exports=n(12)(!1)).push([t.i,"",""])},378:function(t,e,n){"use strict";n(48),n(25),n(18),n(16),n(37);var o=n(19),r={name:"block",components:{},props:["block","blockSelected"],data:function(){return{}},computed:{},mounted:function(){},methods:{}},c=(n(369),n(6)),l=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"block",class:{past:t.block.isPast,selected:t.blockSelected==t.block.time}},[t.block.count?n("span",[t._v("\n    "+t._s(t.block.count)+"\n  ")]):t._e()])}),[],!1,null,"23f7a8fc",null).exports,d={name:"mode-selection",components:{},props:["mode"],data:function(){return{modeList:["days","months","years"],modeSelected:this.mode}},computed:{},mounted:function(){},methods:{selectMode:function(){this.$emit("change-mode",this.modeSelected)}}},v=(n(371),Object(c.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.modeSelected,expression:"modeSelected"}],staticClass:"form-control",on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.modeSelected=e.target.multiple?n:n[0]},t.selectMode]}},t._l(t.modeList,(function(e,o){return n("option",{key:"mode-selection-"+o,domProps:{value:e}},[t._v("\n      "+t._s(t.$t("modeSelection."+e))+"\n    ")])})),0)])}),[],!1,null,"8c183c18",null).exports),f=n(367),m=n(61),h=n(27);function k(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var _={name:"journey",components:{avatar:m.a,block:l,modeSelection:v,event:f.a},props:{user:Object},data:function(){return{blocks:{},lifePercent:0,livedTimes:0,totalTimes:0,eventModal:!1,blockView:null}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?k(source,!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):k(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(h.b)({blockMode:function(t){return t.blockMode},blockSelected:function(t){return t.blockSelected},eventCounter:function(t){return t.event.eventCounter}})),created:function(){this.createBlocks()},mounted:function(){},watch:{eventCounter:function(){this.createBlocks()}},methods:{changeMode:function(t){this.$store.commit("update",{blockMode:t}),this.createBlocks()},createBlocks:function(){if(!this.user.dob_year||!this.user.dob_month||!this.user.dob_day)return!1;this.blocks={};var t=this.$moment([this.user.dob_year,this.user.dob_month-1,this.user.dob_day]),e=this.$moment(t).add(this.user.lifespan,"years"),n=this.$moment(),o=t.format("YYYY-MM-DD"),r="",c=0;this.livedTimes=n.diff(t,this.blockMode),this.totalTimes=e.diff(t,this.blockMode);var l=null;for(this.blocks[o]={time:o,isPast:!0};!e.isSame(t,this.blockMode);)t.add(1,this.blockMode),o=t.format("YYYY-MM-DD"),r=this.formatDateByType(o,this.blockMode),c=0,this.eventCounter[this.blockMode]&&this.eventCounter[this.blockMode][r]&&(c=this.eventCounter[this.blockMode][r]),this.blocks[o]={time:o,count:c},n.isAfter(t,this.blockMode)?this.blocks[o].isPast=!0:!l&&n.isSame(t,this.blockMode)&&(l=t.format("YYYY-MM-DD"));this.lifePercent=Math.round(100*(this.$moment().get("years")-this.user.dob_year)*100/this.user.lifespan)/100},openEvent:function(t){this.$store.commit("update",{blockSelected:t.time})},viewBlock:function(t){this.blockView=t}}},y=(n(375),Object(c.a)(_,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"journey"},[n("div",{staticClass:"row mb-5"},[n("div",{staticClass:"col-2"},[n("avatar",{attrs:{avatar:t.user.avatar,"is-absolute-avatar":t.user.is_absolute_avatar,width:100,height:100}})],1),t._v(" "),n("div",{staticClass:"col-6"},[n("div",[n("Fa",{attrs:{icon:["fas","user"]}}),t._v(" "+t._s(t.user.name)+"\n      ")],1),t._v(" "),n("div",[n("Fa",{attrs:{icon:["fas","gift"]}}),t._v(" "+t._s(t.$moment([t.user.dob_year,t.user.dob_month-1,t.user.dob_day]).format(t.$store.state.dateFormat))+"\n      ")],1),t._v(" "),n("div",[n("Fa",{attrs:{icon:["fas","clock"]}}),t._v("\n        "+t._s(t.$t("journey.lived"))+"\n        "+t._s(t.livedTimes)+"/"+t._s(t.totalTimes)+"\n        "+t._s(t.$t("modeSelection."+t.blockMode))+"\n        "),t.lifePercent?n("span",[t._v("("+t._s(t.lifePercent)+"% "+t._s(t.$t("journey.life"))+") ")]):t._e()],1)])]),t._v(" "),n("p"),n("div",{staticClass:"row mb-2"},[n("div",{staticClass:"col-2"},[n("mode-selection",{attrs:{mode:t.blockMode},on:{"change-mode":t.changeMode}})],1),t._v(" "),n("div",{staticClass:"col-4"}),t._v(" "),n("div",{staticClass:"col-6"},[n("div",{staticClass:"float-right"},[t.blockView?n("div",{staticClass:"badge badge-default w-100"},[t._v("\n          "+t._s(t.$t("journey.dateHover"))+"\n          "+t._s(t.$moment(t.blockView.time).format(t.$store.state.dateFormat))+"\n        ")]):t._e(),t._v(" "),n("div",{staticClass:"clear-fix"}),t._v(" "),n("div",{staticClass:"badge badge-danger w-100"},[t._v("\n          "+t._s(t.$t("journey.dateSelected"))+"\n          "+t._s(t.$moment(t.blockSelected).format(t.$store.state.dateFormat))+"\n        ")])])])]),t._v(" "),n("div",{staticClass:"row"},[Object.keys(t.blocks).length?n("div",{staticClass:"col-12"},t._l(t.blocks,(function(e,o){return n("div",{key:"journey-"+o,on:{click:function(n){return t.openEvent(e)},mouseover:function(n){return t.viewBlock(e)}}},[n("block",{attrs:{block:e,blockSelected:t.blockSelected}})],1)})),0):t._e()]),t._v(" "),n("p")])}),[],!1,null,"38417402",null));e.a=y.exports},385:function(t,e,n){"use strict";n.r(e);n(48),n(25),n(18),n(16),n(37),n(26);var o=n(19),r=n(27),c=n(378),l=n(367);function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}e.default={name:"user",layout:"main",components:{journey:c.a,event:l.a},props:[],data:function(){return{}},computed:function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(source,!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(source).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},Object(r.b)({user:function(t){return t.user}})),created:function(){var t,time,e;return regeneratorRuntime.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.$route.params.user,time=this.$moment().format("YYYY-MM-DD"),"months",n.next=5,regeneratorRuntime.awrap(this.request({url:"/api/home?account=".concat(t,"&time=").concat(time,"&mode=").concat("months")}));case 5:(e=n.sent)&&e.data&&(this.$store.commit("user/setUserAccount",e.data.user),this.$store.commit("event/setData",{eventList:e.data.eventList,eventCounter:e.data.eventCounter}));case 7:case"end":return n.stop()}}),null,this)},mounted:function(){},methods:{test:function(){console.log(this)}}}}}]);